<div class="menu-container">
  <!-- Header -->
  <app-header (sidebarToggle)="toggleSidebar()"></app-header>
  
  <!-- Sidebar -->
  <app-sidebar [isCollapsed]="sidebarCollapsed" [showMobileOverlay]="showMobileSidebar"></app-sidebar>
  
  <!-- Main Content -->
  <main class="main-content" [class.sidebar-collapsed]="sidebarCollapsed">
    <div class="content-wrapper">
      <!-- Page Header -->
      <div class="page-header">
        <div class="header-content">
          <h1 class="page-title">Cardápio Digital</h1>
          <p class="page-subtitle">Visualize o cardápio como seus clientes veem</p>
        </div>
        <div class="header-actions">
          <button class="btn-secondary" (click)="togglePreviewMode()">
            <span class="material-icons">{{ previewMode ? 'edit' : 'visibility' }}</span>
            {{ previewMode ? 'Modo Edição' : 'Modo Cliente' }}
          </button>
          <button class="btn-secondary" (click)="exportMenu()">
            <span class="material-icons">download</span>
            Exportar PDF
          </button>
          <button class="btn-primary" (click)="printMenu()">
            <span class="material-icons">print</span>
            Imprimir
          </button>
        </div>
      </div>

      <!-- Menu Controls -->
      <div class="menu-controls" *ngIf="!previewMode">
        <div class="search-container">
          <div class="search-input-wrapper">
            <span class="material-icons search-icon">search</span>
            <input 
              type="text" 
              class="search-input" 
              placeholder="Buscar pratos no cardápio..."
              [(ngModel)]="searchTerm"
              (input)="filterDishes()">
          </div>
        </div>
        
        <div class="filters-container">
          <select class="filter-select" [(ngModel)]="selectedCategory" (change)="filterDishes()">
            <option value="">Todas as categorias</option>
            <option *ngFor="let category of categories" [value]="category.id">{{ category.name }}</option>
          </select>
          
          <select class="filter-select" [(ngModel)]="priceRange" (change)="filterDishes()">
            <option value="">Todas as faixas de preço</option>
            <option value="0-20">Até R$ 20</option>
            <option value="20-40">R$ 20 - R$ 40</option>
            <option value="40-60">R$ 40 - R$ 60</option>
            <option value="60+">Acima de R$ 60</option>
          </select>
          
          <button class="btn-outline" (click)="clearFilters()">
            <span class="material-icons">clear</span>
            Limpar
          </button>
        </div>
      </div>

      <!-- Menu Stats -->
      <div class="menu-stats" *ngIf="!previewMode">
        <div class="stat-item">
          <span class="stat-value">{{ getAvailableDishesCount() }}</span>
          <span class="stat-label">Pratos Disponíveis</span>
        </div>
        <div class="stat-item">
          <span class="stat-value">{{ categories.length }}</span>
          <span class="stat-label">Categorias</span>
        </div>
        <div class="stat-item">
          <span class="stat-value">R$ {{ getAveragePrice() }}</span>
          <span class="stat-label">Preço Médio</span>
        </div>
        <div class="stat-item">
          <span class="stat-value">{{ getAveragePreparationTime() }}min</span>
          <span class="stat-label">Tempo Médio</span>
        </div>
      </div>

      <!-- Menu Display -->
      <div class="menu-display" [class.preview-mode]="previewMode">
        <!-- Restaurant Header (Preview Mode) -->
        <div class="restaurant-header" *ngIf="previewMode">
          <div class="restaurant-logo">
            <span class="logo-text">Food<span class="logo-accent">Flow</span></span>
          </div>
          <div class="restaurant-info">
            <h2 class="restaurant-name">Restaurante Exemplo</h2>
            <p class="restaurant-description">Sabores únicos e experiências inesquecíveis</p>
            <div class="restaurant-contact">
              <span class="contact-item">
                <span class="material-icons">phone</span>
                (11) 99999-9999
              </span>
              <span class="contact-item">
                <span class="material-icons">location_on</span>
                Rua Exemplo, 123 - São Paulo
              </span>
            </div>
          </div>
        </div>

        <!-- Categories Navigation -->
        <div class="categories-nav" *ngIf="activeCategories.length > 0">
          <div class="nav-title" *ngIf="!previewMode">Navegação por Categorias</div>
          <div class="category-tabs">
            <button 
              class="category-tab" 
              [class.active]="!selectedCategory"
              (click)="selectCategory('')">
              Todos
            </button>
            <button 
              *ngFor="let category of activeCategories" 
              class="category-tab"
              [class.active]="selectedCategory === category.id"
              [style.border-color]="category.color"
              [style.color]="selectedCategory === category.id ? category.color : ''"
              (click)="selectCategory(category.id)">
              <span class="material-icons">{{ category.icon }}</span>
              {{ category.name }}
            </button>
          </div>
        </div>

        <!-- Menu Categories -->
        <div class="menu-categories">
          <div 
            *ngFor="let category of getDisplayCategories()" 
            class="menu-category"
            [id]="'category-' + category.id">
            
            <div class="category-header">
              <div class="category-icon" [style.background-color]="category.color">
                <span class="material-icons">{{ category.icon }}</span>
              </div>
              <div class="category-info">
                <h3 class="category-name">{{ category.name }}</h3>
                <p class="category-description">{{ category.description }}</p>
                <div class="category-count">{{ getCategoryDishesCount(category.id) }} pratos disponíveis</div>
              </div>
            </div>

            <!-- Category Dishes -->
            <div class="category-dishes">
              <div 
                *ngFor="let dish of getCategoryDishes(category.id)" 
                class="menu-item"
                [class.unavailable]="dish.status === 'unavailable'">
                
                <div class="dish-image-container">
                  <img [src]="dish.image" [alt]="dish.name" class="dish-image" loading="lazy">
                  <div class="dish-status" *ngIf="dish.status === 'unavailable'">
                    <span class="material-icons">block</span>
                  </div>
                  <div class="prep-time" *ngIf="dish.status === 'available'">
                    <span class="material-icons">schedule</span>
                    {{ dish.preparationTime }}min
                  </div>
                </div>
                
                <div class="dish-content">
                  <div class="dish-header">
                    <h4 class="dish-name">{{ dish.name }}</h4>
                    <div class="dish-price">
                      <span class="price-value">R$ {{ dish.price.toFixed(2) }}</span>
                    </div>
                  </div>
                  
                  <p class="dish-description">{{ dish.description }}</p>
                  
                  <div class="dish-ingredients" *ngIf="dish.ingredients.length > 0">
                    <span class="ingredients-label">Ingredientes:</span>
                    <div class="ingredients-list">
                      <span 
                        *ngFor="let ingredient of dish.ingredients.slice(0, 4); let last = last" 
                        class="ingredient">
                        {{ ingredient.name }}{{ !last ? ',' : '' }}
                      </span>
                      <span *ngIf="dish.ingredients.length > 4" class="more-ingredients">
                        +{{ dish.ingredients.length - 4 }} mais
                      </span>
                    </div>
                  </div>
                  
                  <div class="dish-actions" *ngIf="!previewMode && dish.status === 'available'">
                    <button class="btn-edit" (click)="editDish(dish)">
                      <span class="material-icons">edit</span>
                      Editar
                    </button>
                    <button class="btn-toggle" (click)="toggleDishAvailability(dish)">
                      <span class="material-icons">visibility_off</span>
                      Desativar
                    </button>
                  </div>
                  
                  <div class="dish-actions" *ngIf="!previewMode && dish.status === 'unavailable'">
                    <button class="btn-edit" (click)="editDish(dish)">
                      <span class="material-icons">edit</span>
                      Editar
                    </button>
                    <button class="btn-toggle active" (click)="toggleDishAvailability(dish)">
                      <span class="material-icons">visibility</span>
                      Ativar
                    </button>
                  </div>
                </div>
              </div>
              
              <!-- Empty Category -->
              <div class="empty-category" *ngIf="getCategoryDishes(category.id).length === 0">
                <span class="material-icons">restaurant_menu</span>
                <p>Nenhum prato disponível nesta categoria</p>
              </div>
            </div>
          </div>
        </div>

        <!-- Empty State -->
        <div class="empty-menu" *ngIf="getDisplayCategories().length === 0">
          <div class="empty-icon">
            <span class="material-icons">restaurant_menu</span>
          </div>
          <h3 class="empty-title">Cardápio vazio</h3>
          <p class="empty-message">
            {{ searchTerm || selectedCategory || priceRange ? 
               'Nenhum prato encontrado com os filtros aplicados.' : 
               'Adicione pratos e categorias para começar a montar seu cardápio.' }}
          </p>
          <button class="btn-primary" (click)="goToAddDish()" *ngIf="!searchTerm && !selectedCategory && !priceRange">
            <span class="material-icons">add</span>
            Adicionar Primeiro Prato
          </button>
        </div>

        <!-- Menu Footer (Preview Mode) -->
        <div class="menu-footer" *ngIf="previewMode">
          <div class="footer-content">
            <div class="footer-section">
              <h4>Horário de Funcionamento</h4>
              <p>Segunda a Sexta: 11h às 23h</p>
              <p>Sábado e Domingo: 12h às 24h</p>
            </div>
            <div class="footer-section">
              <h4>Formas de Pagamento</h4>
              <p>Dinheiro, Cartão, PIX</p>
              <p>Aceitamos todos os cartões</p>
            </div>
            <div class="footer-section">
              <h4>Delivery</h4>
              <p>Entregamos em toda a região</p>
              <p>Taxa de entrega: R$ 5,00</p>
            </div>
          </div>
          <div class="footer-bottom">
            <p>Cardápio gerado pelo FoodFlow • {{ getCurrentDate() }}</p>
          </div>
        </div>
      </div>
    </div>
  </main>
</div>

