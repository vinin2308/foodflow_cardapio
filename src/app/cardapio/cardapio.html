<div class="cardapio-container">
  
  <!-- 1. HEADER (Exibe Mesa e Nome do Cliente salvos) -->
  <header class="cardapio-header">
    <div class="header-info">
      <h1>FoodFlow</h1>
      <div class="mesa-info">
        <span class="mesa">Mesa {{ mesa }}</span>
        <!-- Se o nomeCliente estiver preenchido no TS, ele aparece aqui -->
        <span class="cliente" *ngIf="nomeCliente">üë§ {{ nomeCliente }}</span>
      </div>
    </div>
    
    <!-- Informa√ß√µes da Comanda (C√≥digo) -->
    <div class="comanda-info" *ngIf="comanda">
      <span class="codigo-acesso">
        <ng-container *ngIf="comanda.eh_principal; else comandaFilha">
          Comanda Princ. ‚Ä¢ <strong>{{ codigoAcesso }}</strong>
        </ng-container>
        <ng-template #comandaFilha>
          Comanda Vinc. ‚Ä¢ <strong>{{ codigoAcesso }}</strong>
        </ng-template>
      </span>
    </div>

    <!-- Bot√µes de A√ß√£o -->
    <div class="header-actions">
      <button class="garcom-btn" (click)="chamarGarcom()" title="Chamar Gar√ßom">
        üîî
      </button>
      <button class="carrinho-btn" (click)="toggleCarrinho()" id="abrir-carrinho">
        üõí
        <span class="badge" *ngIf="quantidadeTotalItens > 0">{{ quantidadeTotalItens }}</span>
      </button>
    </div>
  </header> 

  <!-- 2. NAVEGA√á√ÉO DE CATEGORIAS -->
  <nav class="categorias-nav">
    <button 
      *ngFor="let categoria of categorias"
      class="categoria-btn"
      [class.ativa]="categoriaAtiva?.id === categoria.id"
      (click)="selecionarCategoria(categoria)"
      [attr.id]="'categoria-' + categoria.id"
    >
      <span class="icone">{{ categoria.icone }}</span>
      <span class="nome">{{ categoria.nome }}</span>
    </button>
  </nav>

  <!-- 3. LISTA DE ITENS -->
  <main class="cardapio-content">
    <div class="categoria-section" *ngIf="categoriaAtiva">
      <h2 class="categoria-titulo">
        {{ categoriaAtiva.icone }} {{ categoriaAtiva.nome }}
      </h2>

      <div class="itens-grid">
        <div 
          class="item-card" 
          *ngFor="let item of getItensPorCategoria(categoriaAtiva)"
        >
          <!-- WRAPPER: Agrupa Texto e Imagem para ficarem lado a lado -->
          <div class="item-main-content" style="display: flex; justify-content: space-between; gap: 10px;">
            
            <div class="item-info">
              <h3 class="item-nome">{{ item.nome }}</h3>
              <p class="item-descricao">{{ item.descricao }}</p>
              <span class="item-preco">{{ formatarPreco(item.preco) }}</span>
            </div>

            <!-- IMAGEM AQUI: S√≥ aparece se existir no JSON -->
            <div class="item-img-wrapper" *ngIf="item.imagem">
               <img [src]="item.imagem" alt="{{ item.nome }}" class="produto-imagem">
            </div>

          </div>
          
          <!-- A√á√ïES (Bot√µes ficam embaixo) -->
          <div class="item-actions">
            <button 
              class="btn-observacao" 
              (click)="abrirModalObservacao(item)"
              title="Adicionar observa√ß√£o"
              [attr.id]="'adicionar-observacao-' + item.id"
            >
              ‚úèÔ∏è
            </button>
            <button 
              class="btn-adicionar" 
              (click)="adicionarItem(item)"
              [attr.id]="'adicionar-item-' + item.id"
            >
              + Adicionar
            </button>
          </div>

        </div>
      </div>
    </div>
  </main>

  <!-- 4. COMPONENTE CARRINHO (Sem Inputs extras necess√°rios) -->
  <!-- O Carrinho j√° se vira sozinho pegando os dados do Service/LocalStorage -->
  <app-carrinho 
    *ngIf="carrinhoAberto"
    (fechar)="toggleCarrinho()"
  ></app-carrinho>

  <!-- Modal de Observa√ß√£o -->
  <app-observacao-modal
    *ngIf="mostrarModalObservacao"
    [item]="itemSelecionadoParaObservacao"
    (confirmar)="adicionarItemComObservacao($event)"
    (cancelar)="fecharModalObservacao()"
  ></app-observacao-modal>
</div>